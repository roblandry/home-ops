apiVersion: k8s.mariadb.com/v1alpha1
kind: MariaDB
metadata:
  name: mariadb-clean
  namespace: database
spec:

  initContainers:
    - name: mariadb-init
      image: busybox:1.36
      command:
        - sh
        - -c
        - |
          # Removing any ib_logfile* files that might cause startup issues
          # rm -f /var/lib/mysql/ib_logfile*
          ls -la /var/lib/mysql/
      volumeMounts:
        - mountPath: /var/lib/mysql
          name: storage


  # # Additional sidecar containers to be added to the MariaDB Pod.
  # sidecarContainers:
  #   - name: sidecar
  #     image: busybox:1.36
  #     args:
  #       - sleep
  #       - infinity
  #     # Additional env added to the container. By default, all the MariaDB container environment is included.
  #     env:
  #       - name: INSTANCE_NAME
  #         valueFrom:
  #           fieldRef:
  #             fieldPath: metadata.labels['app.kubernetes.io/instance']
  #       - name: MARIADB_PASSWORD
  #         valueFrom:
  #           secretKeyRef:
  #             name: mariadb
  #             key: password

  # # Additional volumes to be mounted by containers.
  # volumes:
  #   - name: tmp
  #     emptyDir:
  #       sizeLimit: 100Mi
  #   - name: mariadb-secret
  #     secret:
  #       secretName: mariadb
  #   - name: mariadb-configmap
  #     configMap:
  #       name: mariadb
  # # Additional volumeMounts to be used by all containers. By default, all the MariaDB container volumeMounts are included.
  # volumeMounts:
  #   - name: tmp
  #     mountPath: /tmp
  #   - name: mariadb-secret
  #     mountPath: /mariadb-secret
  #   - name: mariadb-configmap
  #     mountPath: /mariadb-configmap

  # storage:
  #   size: 1Gi
